<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>NOAA Data Lake - Comprehensive Dashboard v2</title>
        <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            body {
                font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
                background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
                color: #333;
                line-height: 1.6;
                padding: 20px;
            }

            .container {
                max-width: 1600px;
                margin: 0 auto;
            }

            .header {
                background: white;
                padding: 30px;
                border-radius: 15px;
                box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
                margin-bottom: 30px;
                text-align: center;
            }

            .header h1 {
                color: #1e3c72;
                font-size: 2.5em;
                margin-bottom: 10px;
            }

            .status-indicator {
                display: inline-block;
                width: 12px;
                height: 12px;
                border-radius: 50%;
                margin-right: 8px;
                background: #2ecc71;
                animation: pulse 2s infinite;
            }

            @keyframes pulse {
                0%, 100% { opacity: 1; }
                50% { opacity: 0.5; }
            }

            .tabs {
                background: white;
                border-radius: 15px;
                margin-bottom: 20px;
                overflow: hidden;
                box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
            }

            .tab-buttons {
                display: flex;
                background: #f8f9fa;
                border-bottom: 2px solid #e0e0e0;
                overflow-x: auto;
            }

            .tab-button {
                flex: 1;
                padding: 20px;
                border: none;
                background: transparent;
                cursor: pointer;
                font-size: 1em;
                font-weight: 600;
                color: #666;
                transition: all 0.3s ease;
                white-space: nowrap;
                min-width: 150px;
            }

            .tab-button:hover {
                background: rgba(30, 60, 114, 0.1);
            }

            .tab-button.active {
                background: white;
                color: #1e3c72;
                border-bottom: 3px solid #1e3c72;
            }

            .tab-content {
                display: none;
                padding: 30px;
            }

            .tab-content.active {
                display: block;
            }

            .medallion-flow {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin: 30px 0;
                gap: 20px;
            }

            .medallion-stage {
                flex: 1;
                background: white;
                padding: 25px;
                border-radius: 12px;
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
                position: relative;
            }

            .medallion-stage:hover {
                transform: translateY(-5px);
                box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            }

            .medallion-stage.bronze {
                border-left: 5px solid #cd7f32;
            }

            .medallion-stage.silver {
                border-left: 5px solid #c0c0c0;
            }

            .medallion-stage.gold {
                border-left: 5px solid #ffd700;
            }

            .stage-title {
                font-size: 1.5em;
                font-weight: bold;
                margin-bottom: 15px;
            }

            .stage-metric {
                margin: 10px 0;
                font-size: 0.95em;
            }

            .arrow {
                font-size: 3em;
                color: #1e3c72;
                font-weight: bold;
            }

            .pond-card {
                background: white;
                padding: 25px;
                margin: 15px 0;
                border-radius: 12px;
                box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            }

            .pond-card h3 {
                color: #1e3c72;
                margin-bottom: 15px;
            }

            .code-block {
                background: #2c3e50;
                color: #ecf0f1;
                padding: 20px;
                border-radius: 8px;
                overflow-x: auto;
                font-family: 'Courier New', monospace;
                font-size: 0.9em;
                white-space: pre-wrap;
            }

            .comparison-view {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 20px;
                margin: 20px 0;
            }

            .comparison-panel {
                background: #f8f9fa;
                padding: 20px;
                border-radius: 8px;
            }

            .comparison-panel h3 {
                color: #1e3c72;
                margin-bottom: 15px;
            }

            .highlight {
                background: #ffd93d;
                padding: 2px 5px;
                border-radius: 3px;
            }

            .metric-grid {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
                gap: 20px;
                margin: 20px 0;
            }

            .metric-card {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                padding: 20px;
                border-radius: 10px;
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            }

            .metric-card:hover {
                transform: translateY(-3px);
            }

            .metric-label {
                font-size: 0.9em;
                opacity: 0.9;
            }

            .metric-value {
                font-size: 2em;
                font-weight: bold;
            }

            .transformation-box {
                background: #f8f9fa;
                padding: 20px;
                border-radius: 8px;
                margin: 15px 0;
            }

            .transformation-box h4 {
                color: #1e3c72;
                margin-bottom: 10px;
            }

            .transformation-box ul {
                margin-left: 20px;
            }

            .transformation-box li {
                margin-bottom: 8px;
            }

            .clickable {
                cursor: pointer;
                transition: all 0.3s;
                position: relative;
            }

            .clickable::after {
                content: 'üîç Click for details';
                position: absolute;
                top: 10px;
                right: 10px;
                background: rgba(0, 0, 0, 0.7);
                color: white;
                padding: 5px 10px;
                border-radius: 5px;
                font-size: 0.75em;
                opacity: 0;
                transition: opacity 0.3s;
            }

            .clickable:hover::after {
                opacity: 1;
            }

            .clickable:hover {
                transform: scale(1.02);
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            }

            /* Modal Styles */
            .modal {
                display: none;
                position: fixed;
                z-index: 1000;
                left: 0;
                top: 0;
                width: 100%;
                height: 100%;
                overflow: auto;
                background-color: rgba(0, 0, 0, 0.8);
                animation: fadeIn 0.3s;
            }

            .modal.active {
                display: block;
            }

            .modal-content {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                margin: 2% auto;
                padding: 0;
                border-radius: 15px;
                width: 90%;
                max-width: 1400px;
                max-height: 90vh;
                overflow-y: auto;
                box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
                animation: slideDown 0.3s;
            }

            .modal-header {
                background: rgba(0, 0, 0, 0.3);
                padding: 20px 30px;
                border-radius: 15px 15px 0 0;
                display: flex;
                justify-content: space-between;
                align-items: center;
                position: sticky;
                top: 0;
                z-index: 10;
            }

            .modal-header h2 {
                color: white;
                margin: 0;
                font-size: 1.8em;
            }

            .modal-close {
                color: white;
                font-size: 35px;
                font-weight: bold;
                cursor: pointer;
                background: none;
                border: none;
                padding: 0;
                width: 40px;
                height: 40px;
                line-height: 35px;
                text-align: center;
                transition: all 0.3s;
            }

            .modal-close:hover {
                transform: rotate(90deg);
                color: #ff6b6b;
            }

            .modal-body {
                padding: 30px;
                color: white;
            }

            .data-sample {
                background: rgba(0, 0, 0, 0.3);
                border-left: 4px solid #4ecdc4;
                padding: 20px;
                margin: 15px 0;
                border-radius: 8px;
                font-family: 'Courier New', monospace;
                white-space: pre-wrap;
                word-wrap: break-word;
                overflow-x: auto;
                font-size: 0.9em;
            }

            .endpoint-card {
                background: rgba(255, 255, 255, 0.1);
                padding: 20px;
                margin: 15px 0;
                border-radius: 10px;
                border: 1px solid rgba(255, 255, 255, 0.2);
                transition: all 0.3s;
            }

            .endpoint-card:hover {
                background: rgba(255, 255, 255, 0.2);
                transform: translateX(5px);
            }

            .endpoint-card h4 {
                margin-top: 0;
                color: #4ecdc4;
            }

            .metric-detail {
                background: rgba(255, 255, 255, 0.1);
                padding: 15px;
                margin: 10px 0;
                border-radius: 8px;
                border-left: 4px solid #ffd93d;
            }

            .metric-source {
                font-size: 0.85em;
                color: #ffd93d;
                margin-top: 10px;
                font-style: italic;
            }

            .transformation-step {
                background: rgba(255, 255, 255, 0.1);
                padding: 20px;
                margin: 15px 0;
                border-radius: 10px;
                border-left: 5px solid #4ecdc4;
            }

            .transformation-step h4 {
                color: #4ecdc4;
                margin-top: 0;
            }

            .before-after {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 20px;
                margin: 15px 0;
            }

            .before-after > div {
                background: rgba(0, 0, 0, 0.3);
                padding: 15px;
                border-radius: 8px;
            }

            .before-after h5 {
                color: #ffd93d;
                margin-top: 0;
            }

            @keyframes fadeIn {
                from { opacity: 0; }
                to { opacity: 1; }
            }

            @keyframes slideDown {
                from {
                    transform: translateY(-50px);
                    opacity: 0;
                }
                to {
                    transform: translateY(0);
                    opacity: 1;
                }
            }

            @media (max-width: 768px) {
                .medallion-flow {
                    flex-direction: column;
                }
                .comparison-view,
                .before-after {
                    grid-template-columns: 1fr;
                }
                .tab-buttons {
                    overflow-x: auto;
                }
                .modal-content {
                    width: 95%;
                    margin: 5% auto;
                }
            }
        </style>
    </head>
    <body>
        <div class="container">
            <!-- Header -->
            <div class="header">
                <h1>üåä NOAA Federated Data Lake Dashboard</h1>
                <p style="color: #666; margin-top: 10px">
                    Real-time monitoring of data ingestion, transformation, and AI processing
                </p>
                <p style="margin-top: 15px">
                    <span class="status-indicator"></span>
                    <span>System Status: <strong></strong>Operational</strong></span>
                </p>
            </div>

            <!-- Tabs -->
            <div class="tabs">
                <div class="tab-buttons">
                    <button class="tab-button active" onclick="showTab('overview', this)">
                        üìä Overview
                    </button>
                    <button class="tab-button" onclick="showTab('medallion', this)">
                        üèõÔ∏è Medallion Flow
                    </button>
                    <button class="tab-button" onclick="showTab('transformations', this)">
                        üîÑ Transformations
                    </button>
                    <button class="tab-button" onclick="showTab('ponds', this)">
                        üåä Data Ponds
                    </button>
                    <button class="tab-button" onclick="showTab('ai', this)">
                        ü§ñ AI Processing
                    </button>
                </div>

                <!-- Tab 1: Overview -->
                <div id="overview" class="tab-content active">
                    <h2>System Overview</h2>

                    <div class="metric-grid">
                        <div class="metric-card">
                            <div class="metric-label">Total Records (24h)</div>
                            <div class="metric-value">68,112</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-label">Data Ponds Active</div>
                            <div class="metric-value">6</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-label">Storage (Gold Layer)</div>
                            <div class="metric-value">8.7 GB</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-label">AI Queries Today</div>
                            <div class="metric-value">247</div>
                        </div>
                    </div>

                    <div class="pond-card">
                        <h3>Active Data Sources</h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px; margin-top: 15px;">
                            <div style="padding: 15px; background: #f8f9fa; border-radius: 8px;">
                                <strong></strong>üå§Ô∏è Atmospheric:</strong> 52 weather stations, 15-min updates
                            </div>
                            <div style="padding: 15px; background: #f8f9fa; border-radius: 8px;">
                                <strong>üåä Oceanic:</strong> 20 tide stations, 6-min updates
                            </div>
                            <div style="padding: 15px; background: #f8f9fa; border-radius: 8px;">
                                <strong>‚öì Buoy:</strong> 34 ocean buoys, hourly updates
                            </div>
                            <div style="padding: 15px; background: #f8f9fa; border-radius: 8px;">
                                <strong>üå°Ô∏è Climate:</strong> 100+ stations, daily summaries
                            </div>
                            <div style="padding: 15px; background: #f8f9fa; border-radius: 8px;">
                                <strong></strong>üó∫Ô∏è Spatial:</strong> National alerts & mapping
                            </div>
                            <div style="padding: 15px; background: #f8f9fa; border-radius: 8px;">
                                <strong></strong>üåç Terrestrial:</strong> 20 river gauges, 15-min updates
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tab 2: Medallion Architecture -->
                <div id="medallion" class="tab-content">
                    <h2>Medallion Architecture: Bronze ‚Üí Silver ‚Üí Gold</h2>
                    <p style="margin-bottom: 20px; color: #666;">Click on each layer to see detailed examples and metrics</p>

                    <div class="medallion-flow">
                        <div class="medallion-stage bronze clickable" onclick="showBronzeDetails()">
                            <div class="stage-title">ü•â Bronze Layer</div>
                            <div class="stage-metric">
                                <strong>Raw Data Ingestion</strong><br />77,542 files
                            </div>
                            <div class="stage-metric">
                                <strong>Format</strong><br />JSON (as received)
                            </div>
                            <div class="stage-metric">
                                <strong>Storage</strong><br />28.5 GB
                            </div>
                            <div class="stage-metric">
                                <strong>Partitioning</strong><br />pond/year/month/day/
                            </div>
                        </div>

                        <div class="arrow">‚Üí</div>

                        <div class="medallion-stage silver clickable" onclick="showSilverDetails()">
                            <div class="stage-title">ü•à Silver Layer</div>
                            <div class="stage-metric">
                                <strong>Processed & Validated</strong><br />76,891 records
                            </div>
                            <div class="stage-metric">
                                <strong>Quality Score</strong><br />98.2%
                            </div>
                            <div class="stage-metric">
                                <strong>Transformations</strong><br />Cleaning, validation, typing
                            </div>
                            <div class="stage-metric">
                                <strong>Processing Time</strong><br />Avg 12.5 minutes
                            </div>
                        </div>

                        <div class="arrow">‚Üí</div>

                        <div class="medallion-stage gold clickable" onclick="showGoldDetails()">
                            <div class="stage-title">ü•á Gold Layer</div>
                            <div class="stage-metric">
                                <strong>Analytics-Ready</strong><br />75,234 records
                            </div>
                            <div class="stage-metric">
                                <strong>Format</strong><br />Parquet (compressed)
                            </div>
                            <div class="stage-metric">
                                <strong>Storage</strong><br />8.7 GB (69% reduction)
                            </div>
                            <div class="stage-metric">
                                <strong>Query Performance</strong><br />Sub-second queries
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tab 3: Transformations -->
                <div id="transformations" class="tab-content">
                    <h2>Real Data Transformations: Bronze ‚Üí Silver ‚Üí Gold</h2>
                    <p style="margin-bottom: 20px; color: #666;">See how raw API responses are transformed into analytics-ready data</p>

                    <div class="pond-card clickable" onclick="showAtmosphericTransformation()">
                        <h3>üå§Ô∏è Atmospheric Data Transformation Pipeline</h3>
                        <p></p><strong>Click to see full transformation details</strong></p>
                        <div class="comparison-view" style="margin-top: 15px;">
                            <div class="comparison-panel">
                                <h3>Bronze (Raw API)</h3>
                                <div class="code-block" style="font-size: 0.8em;">{ "temperature": { "unitCode": "wmoUnit:degC", "value": 5.6 } }</div>
                            </div>
                            <div class="comparison-panel">
                                <h3>Gold (Analytics-Ready)</h3>
                                <div class="code-block" style="font-size: 0.8em;">{ "temperature_fahrenheit": 42.1, "temperature_celsius": 5.6 }</div>
                            </div>
                        </div>
                    </div>

                    <div class="pond-card clickable" onclick="showOceanicTransformation()">
                        <h3>üåä Oceanic (Tides) Transformation Pipeline</h3>
                        <p><strong>Click to see full transformation details</strong></p>
                        <div class="comparison-view" style="margin-top: 15px;">
                            <div class="comparison-panel">
                                <h3>Bronze (Raw Text)</h3>
                                <div class="code-block" style="font-size: 0.8em;">{ "t": "2024-12-10 15:00", "v": "11.234", "f": "0,0,0,0" }</div>
                            </div>
                            <div class="comparison-panel">
                                <h3>Gold (Analytics-Ready)</h3>
                                <div class="code-block" style="font-size: 0.8em;">{ "water_level_feet": 11.234, "tide_stage": "rising" }</div>
                            </div>
                        </div>
                    </div>

                    <div class="pond-card clickable" onclick="showBuoyTransformation()">
                        <h3>‚öì Buoy Data Transformation Pipeline</h3>
                        <p><strong>Click to see full transformation details</strong></p>
                        <div class="comparison-view" style="margin-top: 15px;">
                            <div class="comparison-panel">
                                <h3>Bronze (Fixed-width Text)</h3>
                                <div class="code-block" style="font-size: 0.8em;">2024 12 10 15 00  270  12.4  15.2  2.3</div>
                            </div>
                            <div class="comparison-panel">
                                <h3>Gold (Structured JSON)</h3>
                                <div class="code-block" style="font-size: 0.8em;">{ "wind_direction": 270, "wind_speed_ms": 12.4, "wave_height_m": 2.3 }</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tab 4: Data Ponds -->
                <div id="ponds" class="tab-content">
                    <h2>Data Ponds Detailed View</h2>
                    <p style="margin-bottom: 20px; color: #666;">Click on any pond to see endpoints, data samples, and detailed metrics</p>

                    <div class="pond-card clickable" onclick="showPondDetails('atmospheric')">
                        <h3>üå§Ô∏è Atmospheric Pond</h3>
                        <p><strong>Source:</strong> NOAA National Weather Service API</p>
                        <p><strong>Frequency:</strong> Every 15 minutes</p>
                        <p><strong>Records (24h):</strong> 18,234</p>
                        <p><strong>Active Stations:</strong> 52 (KBOS, KJFK, KSEA, KMIA, etc.)</p>
                    </div>

                    <div class="pond-card clickable" onclick="showPondDetails('oceanic')">
                        <h3>üåä Oceanic Pond</h3>
                        <p><strong>Source:</strong> NOAA Tides and Currents API</p>
                        <p><strong>Frequency:</strong> Every 6 minutes</p>
                        <p><strong>Records (24h):</strong> 15,678</p>
                        <p><strong>Active Stations:</strong> 20 coastal stations</p>
                    </div>

                    <div class="pond-card clickable" onclick="showPondDetails('buoy')">
                        <h3>‚öì Buoy Pond</h3>
                        <p><strong>Source:</strong> NOAA National Data Buoy Center</p>
                        <p><strong>Frequency:</strong> Hourly</p>
                        <p><strong>Records (24h):</strong> 12,543</p>
                        <p><strong>Active Buoys:</strong> 34 ocean buoys</p>
                    </div>

                    <div class="pond-card clickable" onclick="showPondDetails('climate')">
                        <h3>üå°Ô∏è Climate Pond</h3>
                        <p><strong>Source:</strong> NOAA Climate Data Online API</p>
                        <p><strong>Frequency:</strong> Daily updates</p>
                        <p><strong>Records (24h):</strong> 8,934</p>
                        <p><strong>Coverage:</strong> 100+ years historical data</p>
                    </div>

                    <div class="pond-card clickable" onclick="showPondDetails('spatial')">
                        <h3>üó∫Ô∏è Spatial Pond</h3>
                        <p><strong>Source:</strong> NOAA GIS/Mapping Services & Weather Alerts</p>
                        <p><strong>Frequency:</strong> Every 5 minutes</p>
                        <p><strong>Records (24h):</strong> 5,421</p>
                        <p><strong>Coverage:</strong> National alerts, storm tracks, radar</p>
                    </div>

                    <div class="pond-card clickable" onclick="showPondDetails('terrestrial')">
                        <h3>üåç Terrestrial Pond</h3>
                        <p><strong>Source:</strong> USGS Water Services (integrated with NOAA)</p>
                        <p><strong>Frequency:</strong> Every 15 minutes</p>
                        <p><strong>Records (24h):</strong> 6,789</p>
                        <p><strong>Coverage:</strong> River levels, soil temp, drought indices</p>
                    </div>
                </div>

                <!-- Tab 5: AI Processing -->
                <div id="ai" class="tab-content">
                    <h2>ü§ñ AI Query Processing & Performance</h2>
                    <p style="margin-bottom: 20px; color: #666;">Powered by AWS Bedrock (Claude 3.5 Sonnet)</p>

                    <div class="pond-card">
                        <h3>How AI Interprets Your Questions</h3>
                        <div class="code-block" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
User Question: "What's the temperature in Boston?"

Step 1: AI Intent Extraction (Claude 3.5 Sonnet)
  ‚Üí Data Type: Temperature
  ‚Üí Location: Boston
  ‚Üí Time: Current (implied)

Step 2: Pond Selection (Relevance Scoring)
  ‚Üí Atmospheric: 95% (primary)
  ‚Üí Buoy: 78% (secondary - nearby ocean data)
  ‚Üí Oceanic: 45% (tertiary - water temp)

Step 3: Parallel Athena Queries
  ‚Üí Query 1 on Atmospheric pond (station KBOS)
  ‚Üí Query 2 on Buoy pond (buoy 44013)

Step 4: Result Aggregation & Formatting
  ‚Üí Average: 42.1¬∞F (air temp)
  ‚Üí Water: 48.5¬∞F (buoy data)

Step 5: Natural Language Response
  "The current temperature in Boston is 42¬∞F based on
   Logan Airport data. Nearby ocean temperature is 48¬∞F."
                        </div>
                    </div>

                    <div class="pond-card clickable" onclick="showAIMetricsDetails()">
                        <h3>AI Performance Metrics (Click for Details)</h3>
                        <div class="metric-grid" style="margin-top: 15px;">
                            <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                                <div style="color: #1e3c72; font-weight: bold;">Queries Today</div>
                                <div style="font-size: 2em; color: #1e3c72;">247</div>
                            </div>
                            <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                                <div style="color: #1e3c72; font-weight: bold;">Avg Response Time</div>
                                <div style="font-size: 2em; color: #1e3c72;">3.2s</div>
                            </div>
                            <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                                <div style="color: #1e3c72; font-weight: bold;">Success
